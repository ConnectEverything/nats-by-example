[1A[1B[0G[?25l[+] Running 1/0
[34m â ¿ Network aa9ac0dd_default  Created                                             0.0s
[0m[?25h             _             _               
 _ __   __ _| |_ ___      | |__   _____  __
| '_ \ / _` | __/ __|_____| '_ \ / _ \ \/ /
| | | | (_| | |_\__ \_____| |_) | (_) >  < 
|_| |_|\__,_|\__|___/     |_.__/ \___/_/\_\
                                           
nats-box v0.12.0
+ NATS_MAIN_URL=nats://0.0.0.0:4222
+ NATS_LEAF_URL=nats://0.0.0.0:4223
+ nsc add operator --generate-signing-key --sys --name local
[ OK ] generated and stored operator key "ODSP5CIIBQGF2DBXL2Z7LPRNHFZUFV77BNFLWEHDXYFISAYCVARNASMT"
[ OK ] added operator "local"
[ OK ] When running your own nats-server, make sure they run at least version 2.2.0
[ OK ] created operator signing key: ODVED3HES2UK5LX5HYDDR3LHA6QWR4VLIKPURN7R4W7IZDBONVB35CIU
[ OK ] created system_account: name:SYS id:AACKNBWQMVMX7KO2ZNJVB5W7U3Y7TZIJMNVB66X2SUTXHXPY3JPQ6IWS
[ OK ] created system account user: name:sys id:UARWXJQZGAVGNWPGZIYKVDEBZJ4PMTXYHEOCSDYWGQGLM2DO56LOMBKM
[ OK ] system account user creds file stored in `/nsc/nkeys/creds/local/SYS/sys.creds`
+ nsc edit operator --require-signing-keys --account-jwt-server-url nats://0.0.0.0:4222
[ OK ] strict signing key usage set to: true
[ OK ] set account jwt server url to "nats://0.0.0.0:4222"
[ OK ] edited operator "local"
+ nsc add account APP
[ OK ] generated and stored account key "ABHOCGIG4Z2RAUIM2MR677SW256MRWPAO6O37SCVO5H2PFG46WUJNPWB"
[ OK ] added account "APP"
+ nsc edit account APP --sk generate
[ OK ] added signing key "ADOR3QTTRSTB25OJWSJYBPD6XX4OLZRDBVRVSRPMTO72BHWHS5NFNQRA"
[ OK ] edited account "APP"
+ nsc add user --account APP user
[ OK ] generated and stored user key "UAFYV6YSOLCMC3ZAIPGMJAEVTDW6X3TPWSJ7HSKHCITSNONT5KZVZOSI"
[ OK ] generated user creds file `/nsc/nkeys/creds/local/APP/user.creds`
[ OK ] added user "user" to account "APP"
+ nsc env
+----------------------------------------------------------------------------------------------------------+
|                                             NSC Environment                                              |
+--------------------+-----+-------------------------------------------------------------------------------+
| Setting            | Set | Effective Value                                                               |
+--------------------+-----+-------------------------------------------------------------------------------+
| $NSC_CWD_ONLY      | No  | If set, default operator/account from cwd only                                |
| $NSC_NO_GIT_IGNORE | No  | If set, no .gitignore files written                                           |
| $NKEYS_PATH        | Yes | /nsc/nkeys                                                                    |
| $NSC_HOME          | No  | /nsc/.config/nats/nsc                                                         |
| $NATS_CA           | No  | If set, root CAs in the referenced file will be used for nats connections     |
|                    |     | If not set, will default to the system trust store                            |
| $NATS_KEY          | No  | If set, the tls key in the referenced file will be used for nats connections  |
| $NATS_CERT         | No  | If set, the tls cert in the referenced file will be used for nats connections |
+--------------------+-----+-------------------------------------------------------------------------------+
| From CWD           |     | No                                                                            |
| Default Stores Dir |     | /nsc/nats/nsc/stores                                                          |
| Current Store Dir  |     | /nsc/nats/nsc/stores                                                          |
| Current Operator   |     | local                                                                         |
| Current Account    |     | APP                                                                           |
| Root CAs to trust  |     | Default: System Trust Store                                                   |
+--------------------+-----+-------------------------------------------------------------------------------+

+ nats context save main-user --server nats://0.0.0.0:4222 --nsc nsc://local/APP/user
NATS Configuration Context "main-user"

      Server URLs: nats://0.0.0.0:4222
      Credentials: /nsc/nkeys/creds/local/APP/user.creds (OK)
       NSC Lookup: nsc://local/APP/user
             Path: /nsc/.config/nats/context/main-user.json

+ nats context save main-sys --server nats://0.0.0.0:4222 --nsc nsc://local/SYS/sys
NATS Configuration Context "main-sys"

      Server URLs: nats://0.0.0.0:4222
      Credentials: /nsc/nkeys/creds/local/SYS/sys.creds (OK)
       NSC Lookup: nsc://local/SYS/sys
             Path: /nsc/.config/nats/context/main-sys.json

+ nats context save leaf-user --server nats://0.0.0.0:4223
NATS Configuration Context "leaf-user"

      Server URLs: nats://0.0.0.0:4223
             Path: /nsc/.config/nats/context/leaf-user.json

+ nsc generate config --nats-resolver --sys-account SYS
Creating the main server conf...
+ echo 'Creating the main server conf...'
+ cat
Creating the leaf node conf...
+ echo 'Creating the leaf node conf...'
+ cat
+ MAIN_PID=98
+ sleep 1
+ nats-server -c main.conf
+ echo 'Pushing the account JWT...'
+ nsc push -a APP
Pushing the account JWT...
[ OK ] push to nats-server "nats://0.0.0.0:4222" using system account "SYS":
       [ OK ] push APP to nats-server with nats account resolver:
              [ OK ] pushed "APP" to nats-server NA6DT64W3LDXSLIWCFAKNWN7R4CIM25QQP4ZPTHZK54ON2YBVIWHE5LQ: jwt updated
              [ OK ] pushed to a total of 1 nats-server
+ LEAF_PID=115
+ sleep 1
+ nats-server -c leaf.conf
+ SERVICE_PID=125
+ sleep 1
+ nats --context main-user reply greet hello
12:01:19 Listening on "greet" in group "NATS-RPLY-22"
+ nats --context leaf-user request greet 
12:01:20 Sending request on "greet"
12:01:20 [#0] Received on subject "greet":


12:01:20 Received with rtt 375.529Âµs
hello

+ kill 125
+ kill 115
+ kill 98
